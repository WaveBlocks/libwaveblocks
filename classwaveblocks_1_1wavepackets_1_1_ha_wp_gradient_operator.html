<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>WaveBlocksND: waveblocks::wavepackets::HaWpGradientOperator&lt; D, MultiIndex &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WaveBlocksND
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacewaveblocks.html">waveblocks</a></li><li class="navelem"><a class="el" href="namespacewaveblocks_1_1wavepackets.html">wavepackets</a></li><li class="navelem"><a class="el" href="classwaveblocks_1_1wavepackets_1_1_ha_wp_gradient_operator.html">HaWpGradientOperator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classwaveblocks_1_1wavepackets_1_1_ha_wp_gradient_operator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">waveblocks::wavepackets::HaWpGradientOperator&lt; D, MultiIndex &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class applies the gradient operator \( -i\varepsilon^2\nabla_x \) to an arbitrary scalar wavepacket \( \Phi \).  
 <a href="classwaveblocks_1_1wavepackets_1_1_ha_wp_gradient_operator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="hawp__gradient__operator_8hpp_source.html">hawp_gradient_operator.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:abcfe256d5acac4ddd47e75e0f48ae6ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classwaveblocks_1_1wavepackets_1_1_ha_wp_gradient.html">HaWpGradient</a>&lt; D, MultiIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwaveblocks_1_1wavepackets_1_1_ha_wp_gradient_operator.html#abcfe256d5acac4ddd47e75e0f48ae6ba">operator()</a> (<a class="el" href="classwaveblocks_1_1wavepackets_1_1_abstract_scalar_ha_wp.html">AbstractScalarHaWp</a>&lt; D, MultiIndex &gt; const &amp;wp) const </td></tr>
<tr class="memdesc:abcfe256d5acac4ddd47e75e0f48ae6ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the gradient operator \( -i\varepsilon^2\nabla_x \) to an arbitrary scalar wavepacket \( \Phi \).  <a href="#abcfe256d5acac4ddd47e75e0f48ae6ba">More...</a><br /></td></tr>
<tr class="separator:abcfe256d5acac4ddd47e75e0f48ae6ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;dim_t D, class MultiIndex&gt;<br />
class waveblocks::wavepackets::HaWpGradientOperator&lt; D, MultiIndex &gt;</h3>

<p>This class applies the gradient operator \( -i\varepsilon^2\nabla_x \) to an arbitrary scalar wavepacket \( \Phi \). </p>
<p>All you have to do is: </p><div class="fragment"><div class="line">ScalarHaWp&lt;D,MultiIndex&gt; wavepacket;</div>
<div class="line"></div>
<div class="line"><span class="comment">// ... alter wavepacket ...</span></div>
<div class="line"></div>
<div class="line">HaWpGradientOperator&lt;D,MultiIndex&gt; nabla;</div>
<div class="line">HaWpGradient&lt;D, MultiIndex&gt; gradient = nabla(wavepacket);</div>
</div><!-- fragment --><p>This class uses the <a class="el" href="classwaveblocks_1_1wavepackets_1_1_ha_wp_gradient_evaluator.html" title="This class constructs the coefficients of the Hagedorn gradient wavepacket  applied to an arbitrary s...">HaWpGradientEvaluator</a> to evaluate the coefficients of the resulting wavepacket. This class simplifies taking gradients, since it assembles the resulting wavepacket in contrast to <a class="el" href="classwaveblocks_1_1wavepackets_1_1_ha_wp_gradient_evaluator.html" title="This class constructs the coefficients of the Hagedorn gradient wavepacket  applied to an arbitrary s...">HaWpGradientEvaluator</a>, which just returns the new coefficients.</p>
<p>You cannot apply the gradient to multi-component wavepackets (yet). If you want the gradient of multi-component wavepackets, you have to loop over all components and apply the gradient operator on each component.</p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">D</td><td>The dimensionality of the processed wavepackets. </td></tr>
    <tr><td class="paramname">MultiIndex</td><td>The multi-index type of the processed wavepackets. </td></tr>
  </table>
  </dd>
</dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="abcfe256d5acac4ddd47e75e0f48ae6ba"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;dim_t D, class MultiIndex &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classwaveblocks_1_1wavepackets_1_1_ha_wp_gradient.html">HaWpGradient</a>&lt;D,MultiIndex&gt; <a class="el" href="classwaveblocks_1_1wavepackets_1_1_ha_wp_gradient_operator.html">waveblocks::wavepackets::HaWpGradientOperator</a>&lt; D, MultiIndex &gt;::operator() </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classwaveblocks_1_1wavepackets_1_1_abstract_scalar_ha_wp.html">AbstractScalarHaWp</a>&lt; D, MultiIndex &gt; const &amp;&#160;</td>
          <td class="paramname"><em>wp</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Applies the gradient operator \( -i\varepsilon^2\nabla_x \) to an arbitrary scalar wavepacket \( \Phi \). </p>
<p><em>Vectorial wavepackets:</em> You cannot apply this function directly to vectorial wavepackets \( \Psi \). You have to apply the gradient to each component \( \Phi_n \) (which is scalar) of the vectorial wavepacket. \( -i\varepsilon^2\nabla \Psi = \left( -i\varepsilon^2\nabla \Phi_1, \dots, -i\varepsilon^2\nabla \Phi_N \right)^T \)</p>
<p><em>Thread-Safety:</em> Computing the gradient involves creating a shape extension. Since computing a shape extension is very expensive, shape extensions are cached. Concurrently applying any gradient operator to the same wavepacket is unsafe (and is pointless anyway) since cached shape extensions are stored inside the wavepacket objects without mutex guard. Till now applying the same gradient operator to different wavepacket objects in parallel is completely safe. But to ensure future compatibility, each thread should use its own gradient operator instance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wp</td><td>The scalar Hagedorn wavepacket </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The wavepacket gradient. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/userdata/raoulb/LWB/libwaveblocks/waveblocks/wavepackets/<a class="el" href="hawp__gradient__operator_8hpp_source.html">hawp_gradient_operator.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 14 2015 19:17:24 for WaveBlocksND by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>

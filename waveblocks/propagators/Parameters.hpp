#pragma once

#include <array>
#include "waveblocks/propagators/SplitCoefs.hpp"

/** \file */

namespace waveblocks {
namespace propagators {

//////////////////////////////////////////////////////////////////////////////////
// Splitting Parameters
//////////////////////////////////////////////////////////////////////////////////

/** \brief namespace containing numerical splitting parameters for intSplit */
namespace splitting_parameters {

	const auto coefLT = SplitCoefs<1,1> (
		{1.000000000000000},
		{1.000000000000000}
	);

	const auto coefS2 = SplitCoefs<2,2> (
		{0.000000000000000, 1.000000000000000},
		{0.500000000000000, 0.500000000000000}
	);

	const auto coefSS = SplitCoefs<2,2> (
		{0.500000000000000, 0.500000000000000},
		{1.000000000000000, 0.000000000000000}
	);

	const auto coefY4 = SplitCoefs<4,4> (
		{0.000000000000000, 1.351207191959658, -1.702414383919316, 1.351207191959658},
		{0.675603595979829, -0.175603595979829, -0.175603595979829, 0.675603595979829}
	);

	const auto coefPRKS6 = SplitCoefs<7,7> (
		{0.000000000000000, 0.209515106613362, -0.143851773179818, 0.434336666566456, 0.434336666566456, -0.143851773179818, 0.209515106613362},
		{0.079203696431196, 0.353172906049774, -0.042065080357719, 0.219376955753500, -0.042065080357719, 0.353172906049774, 0.079203696431196}
	);

	const auto coefBM42 = SplitCoefs<7,7> (
		{0.000000000000000, 0.245298957184271, 0.604872665711080, -0.350171622895351, -0.350171622895351, 0.604872665711080, 0.245298957184271},
		{0.082984406417405, 0.396309801498368, -0.039056304922349, 0.119524194013151, -0.039056304922349, 0.396309801498368, 0.082984406417405}
	);

	const auto coefY61 = SplitCoefs<8,8> (
		{0.000000000000000, 0.784513610477557, 0.235573213359358, -1.177679984178871, 1.315186320683911, -1.177679984178871, 0.235573213359358, 0.784513610477557},
		{0.392256805238779, 0.510043411918458, -0.471053385409756, 0.068753168252520, 0.068753168252520, -0.471053385409756, 0.510043411918458, 0.392256805238779}
	);

	const auto coefKL6 = SplitCoefs<10,10> (
		{0.000000000000000, 0.392161444007314, 0.332599136789359, -0.706246172557639, 0.082213596293551, 0.798543990934830, 0.082213596293551, -0.706246172557639, 0.332599136789359, 0.392161444007314},
		{0.196080722003657, 0.362380290398337, -0.186823517884140, -0.312016288132044, 0.440378793614190, 0.440378793614190, -0.312016288132044, -0.186823517884140, 0.362380290398337, 0.196080722003657}
	);

	const auto coefBM63 = SplitCoefs<15,15> (
		{0.000000000000000, 0.091719152624462, 0.183983170005006, -0.056534365832888, 0.004914688774713, 0.143761127168358, 0.328567693746804, -0.196411466486454, -0.196411466486454, 0.328567693746804, 0.143761127168358, 0.004914688774713, -0.056534365832888, 0.183983170005006, 0.091719152624462},
		{0.037859319840612, 0.102635633102435, -0.025867888266559, 0.314241403071447, -0.130144459517415, 0.106417700369543, -0.008794243128511, 0.207305069056895, -0.008794243128511, 0.106417700369543, -0.130144459517415, 0.314241403071447, -0.025867888266559, 0.102635633102435, 0.037859319840612}
	);

	const auto coefKL8 = SplitCoefs<18,18> (
		{0.000000000000000, 0.130202483088890, 0.561162981775108, -0.389474962644847, 0.158841906555156, -0.395903894133238, 0.184539640978316, 0.258374387686322, 0.295011723609310, -0.605508533830035, 0.295011723609310, 0.258374387686322, 0.184539640978316, -0.395903894133238, 0.158841906555156, -0.389474962644847, 0.561162981775108, 0.130202483088890},
		{0.065101241544445, 0.345682732431999, 0.085844009565131, -0.115316528044846, -0.118530993789041, -0.105682126577461, 0.221457014332319, 0.276693055647816, -0.155248405110362, -0.155248405110362, 0.276693055647816, 0.221457014332319, -0.105682126577461, -0.118530993789041, -0.115316528044846, 0.085844009565131, 0.345682732431999, 0.065101241544445}
	);

	const auto coefKL10 = SplitCoefs<34,34> (
		{0.000000000000000, 0.090406193686073, 0.535918159530301, 0.351232575474940, -0.311168020978158, -0.525563141942635, 0.144479094102252, 0.029835886097482, 0.177861799237398, 0.098269069393416, 0.461799862104119, -0.333778455998819, 0.070956848365248, 0.236669600701269, -0.497259779506610, -0.303996166172373, 0.052469571881001, 0.443733808050191, 0.052469571881001, -0.303996166172373, -0.497259779506610, 0.236669600701269, 0.070956848365248, -0.333778455998819, 0.461799862104119, 0.098269069393416, 0.177861799237398, 0.029835886097482, 0.144479094102252, -0.525563141942635, -0.311168020978158, 0.351232575474940, 0.535918159530301, 0.090406193686073},
		{0.045203096843036, 0.313162176608187, 0.443575367502620, 0.020032277248391, -0.418365581460397, -0.190542023920191, 0.087157490099867, 0.103848842667440, 0.138065434315407, 0.280034465748768, 0.064010703052650, -0.131410803816785, 0.153813224533258, -0.130295089402671, -0.400627972839491, -0.125763297145686, 0.248101689965596, 0.248101689965596, -0.125763297145686, -0.400627972839491, -0.130295089402671, 0.153813224533258, -0.131410803816785, 0.064010703052650, 0.280034465748768, 0.138065434315407, 0.103848842667440, 0.087157490099867, -0.190542023920191, -0.418365581460397, 0.020032277248391, 0.443575367502620, 0.313162176608187, 0.045203096843036}
	);

} // namespace splitting_parameters


//////////////////////////////////////////////////////////////////////////////////
// Perturbed Splitting Parameters
//////////////////////////////////////////////////////////////////////////////////

/** \brief namespace containing numerical perturbed splitting parameters for intSplit */
namespace perturbed_splitting_parameters {

	const auto coefL42 = SplitCoefs<3,2> (
		{0.211324865405187, 0.577350269189626, 0.211324865405187},
		{0.500000000000000, 0.500000000000000}
	);

	const auto coefL62 = SplitCoefs<4,3> (
		{0.112701665379258, 0.387298334620742, 0.387298334620742, 0.112701665379258},
		{0.277777777777778, 0.444444444444444, 0.277777777777778}
	);

	const auto coefL82 = SplitCoefs<5,4> (
		{0.069431844202974, 0.260577634004598, 0.339981043584856, 0.260577634004598, 0.069431844202974},
		{0.173927422568727, 0.326072577431273, 0.326072577431273, 0.173927422568727}
	);

	const auto coefL102 = SplitCoefs<6,5> (
		{0.046910077030668, 0.183855267916490, 0.269234655052842, 0.269234655052842, 0.183855267916490, 0.046910077030668},
		{0.118463442528095, 0.239314335249683, 0.284444444444444, 0.239314335249683, 0.118463442528095}
	);

	const auto coefL84 = SplitCoefs<6,5> (
		{0.075346960269893, 0.517916854688257, -0.093263814958150, -0.093263814958150, 0.517916854688257, 0.075346960269893},
		{0.190225939373677, 0.846524070443526, -1.073500019634406, 0.846524070443526, 0.190225939373677}
	);

} // namespace perturbed_splitting_parameters



//////////////////////////////////////////////////////////////////////////////////
// Processing Splitting Parameters
//////////////////////////////////////////////////////////////////////////////////

namespace processing_splitting_parameters {

	// normal coefficients for time propagation
	const auto coefBCR764 = SplitCoefs<4,4> (
		{0.0, 1.5171479707207228, -2.0342959414414454, 1.5171479707207228}, // alpha
		{0.5600879810924619, -0.06008798109246194, -0.06008798109246194, 0.5600879810924619} // beta
	);
	
	// pre-post processing coefficients
	const auto prepostBCR764 = SplitCoefs<6,6> (
		{-1.621810118086801, 0.0061709468110142, 0.8348493592472594, -0.0511253369989315, 0.5633782670698199, -0.500000000000000}, // Y
		{-0.3346222298730, 1.097567990732164, -1.038088746096783, 0.6234776317921379, -1.102753206303191, -0.0141183222088869} // Z
	);

} // namespace perturbed_splitting_parameters


} // namespace propagators
} // namespace waveblocks
